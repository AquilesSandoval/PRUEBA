<!DOCTYPE html>
<html lang="ES-es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Agregar Atleta :: AIYM</title>
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <link rel="icon" type="image/png" href="../assets/logo_all.png">
    
    <!-- CSS Files -->
    <link href="../assets/fonts.min.css" rel="stylesheet">
    <link href="../assets/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/atlantis2.css" rel="stylesheet">
    <link href="../assets/modern-font.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/demo.css">
    <link rel="stylesheet" href="../assets/alertif.min.css">
    <link rel="stylesheet" href="EDITAR/Atletas Editar.css">
    
    <style>
        /* Toggle Switch CSS */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        
        input:checked + .slider {
            background-color: #19b2eb;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .slider.round {
            border-radius: 24px;
        }
        
        .slider.round:before {
            border-radius: 50%;
        }
    </style>
    
    <script src="../assets/jquery-2.1.4.js.descarga"></script>
</head>

<body data-background-color="bg3">
    <div class="wrapper page-container">
        
        <!-- Header -->
        <div class="main-header" data-background-color="white" style="">
            <div class="nav-top">
                <div class="container d-flex flex-row">
                    <button class="topbar-toggler more"><i class="fas fa-bars"></i></button>
                    
                    <!-- Logo Header -->
                    <a class="logo d-flex align-items-center" href="../index.html">
                        <img src="../assets/logo_all.png" alt="logo" class="navbar-brand">
                    </a>
                    
                    <!-- Navbar Header -->
                    <nav class="navbar navbar-header navbar-expand-lg p-0">
                        <div class="container-fluid p-0">
                            <ul class="navbar-nav topbar-nav ml-md-auto align-items-center">
                                
                                <!-- Training Menu -->
                                <li class="nav-item dropdown hidden-caret">
                                    <a class="nav-link" data-toggle="dropdown" href="#" aria-expanded="false" title="Entrenamientos">
                                        <img src="../assets/menu_entrenamientos.png" style="width: 28px;">
                                    </a>
                                    <div class="dropdown-menu quick-actions quick-actions-info animated fadeIn">
                                        <div class="quick-actions-scroll">
                                            <div class="quick-actions-items">
                                                <div class="row m-0">
                                                    <a class="col-6 col-md-4 p-0" href="../MICRO/INICIO MICRO.html">
                                                        <div class="quick-actions-item">
                                                            <img src="../assets/m_micro.png" style="width: 40px;">
                                                            <span class="text">Microciclo</span>
                                                        </div>
                                                    </a>
                                                    <a class="col-6 col-md-4 p-0" href="../MESO/INICIO MESO.html">
                                                        <div class="quick-actions-item">
                                                            <img src="../assets/m_meso.png" style="width: 40px;">
                                                            <span class="text">Mesociclo</span>
                                                        </div>
                                                    </a>
                                                    <a class="col-6 col-md-4 p-0" href="../MACRO/INICIO MACRO.html">
                                                        <div class="quick-actions-item">
                                                            <img src="../assets/m_macro.png" style="width: 40px;">
                                                            <span class="text">Macrociclo</span>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                
                                <!-- Main Menu -->
                                <li class="nav-item dropdown hidden-caret">
                                    <a class="nav-link" data-toggle="dropdown" href="#" aria-expanded="false" title="Menu">
                                        <img src="../assets/menu_menu.png" style="width: 28px;">
                                    </a>
                                    <div class="dropdown-menu quick-actions quick-actions-info animated fadeIn">
                                        <div class="quick-actions-scroll">
                                            <div class="quick-actions-items">
                                                <div class="row m-0">
                                                    <a class="col-6 col-md-4 p-0" href="../index.html">
                                                        <div class="quick-actions-item">
                                                            <img src="../assets/m_home.png" style="width: 40px;">
                                                            <span class="text">Home</span>
                                                        </div>
                                                    </a>
                                                    <a class="col-6 col-md-4 p-0" href="../ATLETAS/Atletas INICIO.html">
                                                        <div class="quick-actions-item">
                                                            <img src="../assets/m_atletas.png" style="width: 40px;">
                                                            <span class="text">Atletas</span>
                                                        </div>
                                                    </a>
                                                    <a class="col-6 col-md-4 p-0" href="../INFORMES/CONSULTAS/Informes INICIO.html">
                                                        <div class="quick-actions-item">
                                                            <img src="../assets/m_reportes.png" style="width: 40px;">
                                                            <span class="text">Informes</span>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                
                                <!-- User Profile -->
                                <li class="nav-item dropdown hidden-caret">
                                    <a class="dropdown-toggle profile-pic" data-toggle="dropdown" href="#" aria-expanded="false">
                                        <div class="avatar-sm">
                                            <img src="../athlete/default.png" alt="..." class="avatar-img rounded-circle">
                                        </div>
                                    </a>
                                    <ul class="dropdown-menu dropdown-user animated fadeIn">
                                        <div class="dropdown-user-scroll scrollbar-outer">
                                            <li>
                                                <a class="dropdown-item" href="../login.html">Salir</a>
                                            </li>
                                        </div>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-panel">
            <div class="content">
                <div class="page-inner">
                    
                    <!-- Page Header -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="page-navs py-2">
                                <div class="page-header">
                                    <h5 class="page-title">Atletas</h5>
                                    <ul class="breadcrumbs">
                                        <li class="nav-home">
                                            <i class="far fa-folder-open" style="font-size: 18px;"></i>
                                        </li>
                                        <li class="separator">
                                            <i class="flaticon-right-arrow"></i>
                                        </li>
                                        <li class="nav-item">
                                            Agregar nuevo atleta
                                        </li>
                                    </ul>
                                    <div class="ml-auto">
                                        <div class="page-header-breadcrumb">
                                            <a class="btn btn-info btn-sm mr-2 fontBold" href="Atletas INICIO.html">
                                                <i class="icon-arrow-left" style="font-weight:700"></i> Regresar
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Form Card -->
                            <div class="card">
                                <div class="card-body">
                                    
                                    <form id="addAthleteForm">
                                        
                                        <!-- Row 1: Nombre, Apellido, Fecha Nacimiento -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="nombre">Nombre(s) *</label>
                                                    <input type="text" id="nombre" name="nombre" class="form-control form-control-sm" required>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="apellido">Apellidos *</label>
                                                    <input type="text" id="apellido" name="apellido" class="form-control form-control-sm" required>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="fecha_nacimiento">Fecha Nacimiento *</label>
                                                    <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 2: Empresa, Correo, Contraseña -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="empresa">Empresa</label>
                                                    <input type="text" id="empresa" name="empresa" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="email">Correo *</label>
                                                    <input type="email" id="email" name="email" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="password">Contraseña *</label>
                                                    <input type="password" id="password" name="password" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 3: Teléfono, Forma, Fatiga -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="telefono">Teléfono</label>
                                                    <input type="text" id="telefono" name="telefono" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="forma">Forma</label>
                                                    <input type="text" id="forma" name="forma" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="fatiga">Fatiga</label>
                                                    <input type="text" id="fatiga" name="fatiga" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 4: Default Control Zonas para Carrera, Natación, Ciclismo -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="zona_carrera">Default Control Zonas para Carrera</label>
                                                    <select id="zona_carrera" name="zona_carrera" class="form-control form-control-sm">
                                                        <option value="">-- Selecciona --</option>
                                                        <option value="FC">FC</option>
                                                        <option value="Potencia">Potencia</option>
                                                        <option value="Velocidad">Velocidad</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="zona_natacion">Default Control Zonas para Natación</label>
                                                    <select id="zona_natacion" name="zona_natacion" class="form-control form-control-sm">
                                                        <option value="">-- Selecciona --</option>
                                                        <option value="FC">FC</option>
                                                        <option value="Potencia">Potencia</option>
                                                        <option value="Velocidad">Velocidad</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="zona_ciclismo">Default Control Zonas para Ciclismo</label>
                                                    <select id="zona_ciclismo" name="zona_ciclismo" class="form-control form-control-sm">
                                                        <option value="">-- Selecciona --</option>
                                                        <option value="FC">FC</option>
                                                        <option value="Potencia">Potencia</option>
                                                        <option value="Velocidad">Velocidad</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 5: Deporte, Tipo de Contrato -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="deporte_principal">Deporte</label>
                                                    <select id="deporte_principal" name="deporte_principal" class="form-control form-control-sm">
                                                        <option value="">-- Selecciona --</option>
                                                        <option value="Carrera">Carrera</option>
                                                        <option value="Bici">Bici</option>
                                                        <option value="Natación">Natación</option>
                                                        <option value="Triatlón">Triatlón</option>
                                                        <option value="Otro">Otro</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="tipo_contrato">Tipo de contrato</label>
                                                    <select id="tipo_contrato" name="tipo_contrato" class="form-control form-control-sm">
                                                        <option value="">-- Selecciona --</option>
                                                        <option value="Mensual">Mensual</option>
                                                        <option value="Trimestral">Trimestral</option>
                                                        <option value="Semestral">Semestral</option>
                                                        <option value="Anual">Anual</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label">Activo</label><br>
                                                    <label class="switch">
                                                        <input type="checkbox" id="activo" name="activo" checked>
                                                        <span class="slider round"></span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 6: Contacto emergencia 1 -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="contacto_emergencia1">Contacto emergencia</label>
                                                    <input type="text" id="contacto_emergencia1" name="contacto_emergencia1" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="telefono_emergencia1">Teléfono emergencia</label>
                                                    <input type="text" id="telefono_emergencia1" name="telefono_emergencia1" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="parentesco1">Parentesco</label>
                                                    <input type="text" id="parentesco1" name="parentesco1" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 7: Contacto emergencia 2 -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="contacto_emergencia2">Contacto emergencia</label>
                                                    <input type="text" id="contacto_emergencia2" name="contacto_emergencia2" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="telefono_emergencia2">Teléfono emergencia</label>
                                                    <input type="text" id="telefono_emergencia2" name="telefono_emergencia2" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="parentesco2">Parentesco</label>
                                                    <input type="text" id="parentesco2" name="parentesco2" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 8: Tipo de sangre, Alergias, Datos gastos médicos -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="tipo_sangre">Tipo de sangre</label>
                                                    <input type="text" id="tipo_sangre" name="tipo_sangre" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="alergias">Alergias a medicamentos</label>
                                                    <input type="text" id="alergias" name="alergias" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="gastos_medicos">Datos Según Gastos Médicos</label>
                                                    <input type="text" id="gastos_medicos" name="gastos_medicos" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 9: Hospital, Número Afiliación -->
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label" for="hospital">Hospital al que trasladar</label>
                                                    <input type="text" id="hospital" name="hospital" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label" for="numero_federacion">Número Afiliación Federación</label>
                                                    <input type="text" id="numero_federacion" name="numero_federacion" class="form-control form-control-sm">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Row 10: Archivos - Foto, Concierto, Electrocardiograma -->
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="foto">Foto</label>
                                                    <div class="text-center mb-2">
                                                        <img src="../athlete/default.png" id="foto_preview" alt="Foto" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
                                                    </div>
                                                    <input type="file" id="foto" name="foto" class="form-control-file" accept="image/*">
                                                    <button type="button" class="btn btn-sm btn-secondary mt-1" onclick="document.getElementById('foto').click()">Seleccionar archivo</button>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="concierto">Concierto</label>
                                                    <div class="text-center mb-2">
                                                        <i class="fas fa-file-pdf" style="font-size: 60px; color: #999;"></i>
                                                    </div>
                                                    <input type="file" id="concierto" name="concierto" class="form-control-file" accept=".pdf,.doc,.docx">
                                                    <button type="button" class="btn btn-sm btn-secondary mt-1" onclick="document.getElementById('concierto').click()">Seleccionar archivo</button>
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label class="control-label" for="electrocardiograma">Electrocardiograma</label>
                                                    <div class="text-center mb-2">
                                                        <i class="fas fa-heartbeat" style="font-size: 60px; color: #999;"></i>
                                                    </div>
                                                    <input type="file" id="electrocardiograma" name="electrocardiograma" class="form-control-file" accept=".pdf,.doc,.docx,image/*">
                                                    <button type="button" class="btn btn-sm btn-secondary mt-1" onclick="document.getElementById('electrocardiograma').click()">Seleccionar archivo</button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Submit Button -->
                                        <div class="row mt-4">
                                            <div class="col-sm-12 text-right">
                                                <button type="button" class="btn btn-secondary mr-2" onclick="window.location.href='Atletas INICIO.html'">
                                                    <i class="fas fa-times"></i> Cancelar
                                                </button>
                                                <button type="submit" class="btn btn-info">
                                                    <i class="fas fa-save"></i> Guardar Atleta
                                                </button>
                                            </div>
                                        </div>
                                        
                                    </form>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <div style="clear: both;"></div>
            <div class="footer">
                <div class="container">
                    <div class="col-sm-12">
                        <div class="col-sm-3" style="float: left;">
                            <img src="../assets/logo_all.png" alt="logo" class="navbar-brand">
                        </div>
                        <div class="col-sm-9" style="float: left; text-align: right; padding-top: 15px; font-weight: 700; color: #003A5D;">
                            Copyright © 2025 by <a href="http://allinyourmind.es/" target="_blank">ALL IN YOUR MIND</a>
                        </div>
                    </div>
                </div>
                <div style="clear: both;"></div>
            </div>
        </div>
        
    </div>
    
    <!-- Scripts -->
    <script src="../assets/core/popper.min.js.descarga"></script>
    <script src="../assets/core/bootstrap.min.js.descarga"></script>
    <script src="../assets/sweetalert.min.js.descarga"></script>
    
    <script>
        // Form submission
        document.getElementById('addAthleteForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                nombre: document.getElementById('nombre').value,
                apellido: document.getElementById('apellido').value,
                fecha_nacimiento: document.getElementById('fecha_nacimiento').value || null,
                email: document.getElementById('email').value || null,
                telefono: document.getElementById('telefono').value || null,
                genero: document.getElementById('genero').value || null,
                deporte_principal: document.getElementById('deporte_principal').value || null,
                peso: document.getElementById('peso').value ? parseFloat(document.getElementById('peso').value) : null,
                altura: document.getElementById('altura').value ? parseInt(document.getElementById('altura').value) : null,
                notas: document.getElementById('notas').value || null
            };
            
            try {
                const response = await fetch('/api/athletes', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    swal({
                        title: "¡Éxito!",
                        text: "Atleta creado exitosamente",
                        icon: "success",
                        button: "OK"
                    }).then(() => {
                        window.location.href = 'Atletas INICIO.html';
                    });
                } else {
                    swal({
                        title: "Error",
                        text: data.error || "Error al crear atleta",
                        icon: "error",
                        button: "OK"
                    });
                }
            } catch (error) {
                console.error('Error:', error);
                swal({
                    title: "Error",
                    text: "Error de conexión al servidor",
                    icon: "error",
                    button: "OK"
                });
            }
        });
    </script>
</body>
</html>
